<!DOCTYPE html>
<html lang="el">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
   <title>Delivery Tool v66</title>
   <style>
       :root { --p: #30d158; --bg: #000000; --card: #1c1c1e; --txt: #ffffff; --accent: #0a84ff; }
       body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding-bottom: 120px; color: var(--txt); -webkit-tap-highlight-color: transparent; }
       .nav { display: flex; background: #000; padding-top: 50px; border-bottom: 1px solid #2c2c2e; position: sticky; top: 0; z-index: 1000; }
       .nav button { flex: 1; padding: 18px; border: none; background: none; font-weight: 700; color: #8e8e93; font-size: 13px; text-transform: uppercase; }
       .nav button.active { color: var(--p); border-bottom: 3px solid var(--p); }
       .container { padding: 16px; max-width: 600px; margin: auto; }
       .btn-main { background: var(--p); color: #000; width: 100%; padding: 18px; font-size: 17px; border-radius: 12px; border: none; font-weight: 800; margin-bottom: 12px; display: block; }
       .btn-opt { background: var(--accent); color: #fff; width: 100%; padding: 14px; font-size: 14px; border-radius: 10px; border: none; font-weight: 700; margin-bottom: 20px; display: block; text-transform: uppercase; }
       .card { background: var(--card); border-radius: 16px; padding: 15px; margin-bottom: 12px; display: flex; align-items: center; border: 1px solid #2c2c2e; position: relative; }
       .handle { color: #444; padding-right: 15px; font-size: 20px; cursor: grab; }
       .num-badge { background: var(--p); color: #000; min-width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 12px; margin-right: 12px; }
       .info { flex: 1; min-width: 0; }
       .info h4 { margin: 0; font-size: 16px; color: #fff; font-weight: 600; }
       .info p { margin: 3px 0; font-size: 13px; color: #8e8e93; line-height: 1.3; }
       .meta { display: flex; gap: 6px; margin-top: 6px; }
       .tag { font-size: 11px; padding: 4px 8px; border-radius: 20px; font-weight: 700; background: #2c2c2e; color: var(--accent); border: 1px solid #3a3a3c; }
       .btn-edit { background: none; border: none; font-size: 20px; padding: 5px; margin: 0 5px; }
       .btn-go { background: var(--accent); color: #fff; border: none; width: 44px; height: 44px; border-radius: 10px; font-weight: bold; font-size: 12px; }
       .btn-del { background: #ff453a; color: #fff; border: none; width: 44px; height: 44px; border-radius: 10px; margin-left: 8px; font-size: 16px; }
       .hidden { display: none; }
       textarea, input { background: #1c1c1e; border: 1px solid #2c2c2e; color: #fff; padding: 15px; border-radius: 12px; width: 100%; box-sizing: border-box; font-size: 16px; margin-bottom: 12px; }
   </style>
</head>
<body>

<div class="nav">
   <button id="t1" onclick="tab('run')" class="active">Î”Î™Î‘Î”Î¡ÎŸÎœÎ—</button>
   <button id="t2" onclick="tab('base')">Î Î•Î›Î‘Î¤Î•Î£</button>
   <button id="t3" onclick="tab('set')">âš™ï¸ Î•Î™Î£Î‘Î“Î©Î“Î—</button>
</div>

<div id="run-page" class="container">
   <button class="btn-main" onclick="startNav()">ğŸš€ Î•ÎÎ‘Î¡ÎÎ— NAVIGATION</button>
   <button class="btn-opt" onclick="smartSort()">ğŸª„ Î‘Î¥Î¤ÎŸÎœÎ‘Î¤Î— Î£Î•Î™Î¡Î‘ (Î©Î¡Î•Î£ ÎšÎ‘Î¤Î©)</button>
   <div id="run-list"></div>
   <button onclick="clearRun()" style="width:100%; color:#ff453a; background:none; border:none; padding:20px; font-weight:bold; opacity:0.6;">Î£ÎšÎŸÎ¥Î Î‘ (ÎšÎ‘Î˜Î‘Î¡Î™Î£ÎœÎŸÎ£)</button>
</div>

<div id="base-page" class="container hidden">
   <input type="text" id="search" placeholder="ğŸ” Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Ï€ÎµÎ»Î¬Ï„Î·..." onkeyup="renderBase()">
   <div id="base-list"></div>
</div>

<div id="set-page" class="container hidden">
   <textarea id="bulk" rows="8" placeholder="ÎŒÎ½Î¿Î¼Î± .. Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· .. ÎÏÎ± .. Î£Ï‡ÏŒÎ»Î¹Î¿"></textarea>
   <button onclick="saveData()" class="btn-main">Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î—</button>
   <button onclick="exportBackup()" class="btn-opt" style="background:#5856d6; margin-top:20px;">ğŸ’¾ BACKUP (Î‘ÎÎ¤Î™Î“Î¡Î‘Î¦Î— Î’Î‘Î£Î—Î£)</button>
</div>

<script>
   // Î”Î¿ÎºÎ¹Î¼Î¬Î¶Î¿Ï…Î¼Îµ ÏŒÎ»Î± Ï„Î± Ï€Î¹Î¸Î±Î½Î¬ Î¿Î½ÏŒÎ¼Î±Ï„Î± Î¼Î½Î®Î¼Î·Ï‚ Î³Î¹Î± Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Ï„Î¿Ï…Ï‚ Ï€ÎµÎ»Î¬Ï„ÎµÏ‚ ÏƒÎ¿Ï…
   let db = JSON.parse(localStorage.getItem('delivery_db') || localStorage.getItem('savedCustomers') || '[]');
   let rn = JSON.parse(localStorage.getItem('delivery_rn') || '[]');

   function save() {
       localStorage.setItem('delivery_db', JSON.stringify(db));
       localStorage.setItem('delivery_rn', JSON.stringify(rn));
   }

   function tab(t) {
       document.querySelectorAll('.container').forEach(c => c.classList.add('hidden'));
       document.getElementById(t + '-page').classList.remove('hidden');
       document.querySelectorAll('.nav button').forEach(b => b.classList.remove('active'));
       if(t==='run') renderRun();
       if(t==='base') renderBase();
       document.getElementById(t==='run'?'t1':t==='base'?'t2':'t3').classList.add('active');
   }

   function renderRun() {
       const list = document.getElementById('run-list'); list.innerHTML = '';
       rn.forEach((item, idx) => {
           const div = document.createElement('div'); div.className = 'card';
           div.innerHTML = `<div class="handle">â‰¡</div><div class="num-badge">${idx + 1}</div>
               <div class="info"><h4>${item.n}</h4><p>${item.a}</p>
               <div class="meta">${item.t ? `<span class="tag">âŒš ${item.t}</span>` : ''}${item.k ? `<span class="tag" style="color:#ff9500">ğŸ”‘ ${item.k}</span>` : ''}</div></div>
               <button class="btn-edit" onclick="editRun(${idx})">âœï¸</button>
               <button class="btn-go" onclick="window.location.href='comgooglemaps://?daddr='+encodeURIComponent('${item.a}')">GO</button>
               <button class="btn-del" onclick="delRun(${idx})">âœ•</button>`;
           list.appendChild(div);
       });
   }

   function renderBase() {
       const s = document.getElementById('search').value.toLowerCase();
       const list = document.getElementById('base-list'); list.innerHTML = '';
       db.sort((a,b) => a.n.localeCompare(b.n)).forEach((item, i) => {
           if(item.n.toLowerCase().includes(s) || item.a.toLowerCase().includes(s)) {
               const div = document.createElement('div'); div.className = 'card';
               div.innerHTML = `<div class="num-badge" style="background:#444; color:#fff">${i+1}</div>
                   <div class="info"><h4>${item.n}</h4><p>${item.a}</p></div>
                   <button class="btn-edit" onclick="editBase(${i})">âœï¸</button>
                   <button style="background:var(--p); border:none; width:44px; height:44px; border-radius:10px; font-weight:bold; color:#000" onclick="addToRun(${i})">+</button>`;
               list.appendChild(div);
           }
       });
   }

   function addToRun(i) { rn.push({...db[i]}); save(); alert('Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ!'); }
   function delRun(i) { rn.splice(i,1); save(); renderRun(); }
   function clearRun() { if(confirm('Î£Î²Î®ÏƒÎ¹Î¼Î¿;')){ rn=[]; save(); renderRun(); } }
  
   function saveData() {
       const val = document.getElementById('bulk').value; if(!val) return;
       val.split('\n').forEach(line => {
           const p = line.split('..').map(x => x.trim());
           if(p.length >= 2) db.push({ n: p[0], a: p[1], t: p[2] || "", k: p[3] || "" });
       });
       save(); document.getElementById('bulk').value = ''; tab('base');
   }

   function exportBackup() {
       const text = db.map(c => `${c.n} .. ${c.a} .. ${c.t} .. ${c.k}`).join('\n');
       navigator.clipboard.writeText(text).then(() => alert('Î‘Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ! Î¦ÏÎ»Î±Î¾Î­ Ï„Î¿!'));
   }

   function startNav() { if(!rn.length) return; window.location.href = "comgooglemaps://?saddr=&daddr=" + encodeURIComponent(rn.map(i=>i.a).join(' to:')); }

   tab('run');
</script>
</body>
</html>
