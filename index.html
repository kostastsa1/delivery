<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Delivery Pro AU</title>
    <style>
        :root { --blue: #007AFF; --green: #34C759; --bg: #F2F2F7; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding-bottom: 80px; }
        .header { background: white; padding: 20px; text-align: center; border-bottom: 1px solid #D1D1D6; position: sticky; top: 0; z-index: 100; }
        .tab-btn { padding: 10px 20px; border: none; background: none; font-weight: 600; color: #8E8E93; cursor: pointer; }
        .tab-btn.active { color: var(--blue); border-bottom: 2px solid var(--blue); }
        .card { background: white; margin: 10px; padding: 15px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; align-items: center; }
        .info { flex: 1; }
        .name { font-weight: bold; font-size: 1.1em; display: block; }
        .addr { color: #636366; font-size: 0.9em; }
        .time-tag { color: var(--blue); font-weight: 600; font-size: 0.85em; }
        .btn { border: none; border-radius: 8px; padding: 10px; cursor: pointer; font-weight: 600; transition: 0.2s; }
        .btn-add { background: #E5E5EA; color: var(--blue); }
        .btn-go { background: var(--green); color: white; width: 100%; margin-top: 10px; font-size: 1.1em; }
        .btn-del { background: #FF3B30; color: white; padding: 5px 10px; margin-left: 10px; }
        #bulk { width: 90%; height: 150px; margin: 10px; padding: 10px; border-radius: 8px; border: 1px solid #D1D1D6; }
        .search-bar { width: 90%; padding: 12px; margin: 10px; border-radius: 10px; border: 1px solid #D1D1D6; display: block; margin-left: auto; margin-right: auto; }
        .nav-bottom { position: fixed; bottom: 0; width: 100%; background: white; display: flex; justify-content: space-around; padding: 15px 0; border-top: 1px solid #D1D1D6; }
        .handle { cursor: grab; padding-right: 15px; color: #C7C7CC; font-size: 1.5em; }
    </style>
</head>
<body>

<div class="header">
    <h2 id="view-title">Î Î•Î›Î‘Î¤Î•Î£</h2>
</div>

<div id="base-view">
    <input type="text" class="search-bar" id="search" placeholder="ğŸ” Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î¼Î±Î³Î±Î¶Î¹Î¿Ï..." oninput="renderBase()">
    <div id="base-list"></div>
</div>

<div id="route-view" style="display:none;">
    <div id="route-list"></div>
    <div style="padding: 10px;">
        <button class="btn btn-go" onclick="startNav()">ğŸš€ Î•ÎÎ‘Î¡ÎÎ— NAVIGATION</button>
    </div>
</div>

<div id="settings-view" style="display:none; text-align: center;">
    <textarea id="bulk" placeholder="Î•Ï€Î¹ÎºÏŒÎ»Î»Î·ÏƒÎ·: ÎŒÎ½Î¿Î¼Î± .. Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· .. ÎÏÎ±"></textarea><br>
    <button class="btn btn-add" style="width:90%; background: var(--blue); color:white;" onclick="saveData()">Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î— Î£Î¤Î— Î’Î‘Î£Î—</button>
    <p style="color: #8E8E93; font-size: 0.8em; padding: 20px;">Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ Î´ÏÎ¿ Ï„ÎµÎ»ÎµÎ¯ÎµÏ‚ (..) Î±Î½Î¬Î¼ÎµÏƒÎ± ÏƒÏ„Î± ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Î±</p>
</div>

<div class="nav-bottom">
    <button class="tab-btn active" id="btn-base" onclick="tab('base')">Î Î•Î›Î‘Î¤Î•Î£</button>
    <button class="tab-btn" id="btn-route" onclick="tab('route')">Î”Î™Î‘Î”Î¡ÎŸÎœÎ—</button>
    <button class="tab-btn" id="btn-settings" onclick="tab('settings')">âš™ï¸ Î•Î™Î£Î‘Î“Î©Î“Î—</button>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('delivery_db')) || [];
    let route = JSON.parse(localStorage.getItem('delivery_route')) || [];

    function tab(name) {
        document.getElementById('base-view').style.display = name === 'base' ? 'block' : 'none';
        document.getElementById('route-view').style.display = name === 'route' ? 'block' : 'none';
        document.getElementById('settings-view').style.display = name === 'settings' ? 'block' : 'none';
       
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('btn-' + name).classList.add('active');
        document.getElementById('view-title').innerText = name === 'base' ? 'Î Î•Î›Î‘Î¤Î•Î£' : (name === 'route' ? 'Î”Î™Î‘Î”Î¡ÎŸÎœÎ—' : 'Î•Î™Î£Î‘Î“Î©Î“Î—');
       
        if(name === 'base') renderBase();
        if(name === 'route') renderRoute();
    }

    function saveData() {
        const text = document.getElementById('bulk').value;
        if(!text.trim()) return;
       
        text.split('\n').forEach(line => {
            const parts = line.split('..');
            if(parts.length >= 2) {
                db.push({
                    n: parts[0].trim(),
                    a: parts[1].trim(),
                    t: parts[2]?.trim() || "---"
                });
            }
        });

        // Î‘Î›Î¦Î‘Î’Î—Î¤Î™ÎšÎ— Î¤Î‘ÎÎ™ÎÎŸÎœÎ—Î£Î— Î’Î‘Î£Î—Î£
        db.sort((a, b) => a.n.localeCompare(b.n));

        localStorage.setItem('delivery_db', JSON.stringify(db));
        document.getElementById('bulk').value = '';
        tab('base');
    }

    function renderBase() {
        const query = document.getElementById('search').value.toLowerCase();
        const list = document.getElementById('base-list');
        list.innerHTML = '';
       
        db.filter(item => item.n.toLowerCase().includes(query)).forEach((item, idx) => {
            list.innerHTML += `
                <div class="card">
                    <div class="info">
                        <span class="name">${item.n}</span>
                        <span class="addr">${item.a}</span>
                    </div>
                    <button class="btn btn-add" onclick="addToRoute(${idx})">+</button>
                    <button class="btn btn-del" onclick="deleteFromBase(${idx})">Ã—</button>
                </div>`;
        });
    }

    function addToRoute(idx) {
        route.push(db[idx]);
        // Î‘Î¥Î¤ÎŸÎœÎ‘Î¤Î— Î¤Î‘ÎÎ™ÎÎŸÎœÎ—Î£Î— Î”Î™Î‘Î”Î¡ÎŸÎœÎ—Î£ Î’Î‘Î£Î•Î™ Î©Î¡Î‘Î£
        route.sort((a, b) => {
            if(a.t === "---") return 1;
            if(b.t === "---") return -1;
            return a.t.localeCompare(b.t);
        });
        localStorage.setItem('delivery_route', JSON.stringify(route));
        alert('Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ ÏƒÏ„Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î®!');
    }

    function renderRoute() {
        const list = document.getElementById('route-list');
        list.innerHTML = '';
        route.forEach((item, idx) => {
            list.innerHTML += `
                <div class="card">
                    <div class="handle">â˜°</div>
                    <div class="info">
                        <span class="time-tag">${item.t}</span>
                        <span class="name">${item.n}</span>
                        <span class="addr">${item.a}</span>
                    </div>
                    <button class="btn btn-del" onclick="removeFromRoute(${idx})">Ã—</button>
                </div>`;
        });
    }

    function removeFromRoute(idx) {
        route.splice(idx, 1);
        localStorage.setItem('delivery_route', JSON.stringify(route));
        renderRoute();
    }

    function deleteFromBase(idx) {
        if(confirm('Î”Î¹Î±Î³ÏÎ±Ï†Î® Ï€ÎµÎ»Î¬Ï„Î· Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ·;')) {
            db.splice(idx, 1);
            localStorage.setItem('delivery_db', JSON.stringify(db));
            renderBase();
        }
    }

    function startNav() {
        if(route.length === 0) return alert('Î— Î´Î¹Î±Î´ÏÎ¿Î¼Î® ÎµÎ¯Î½Î±Î¹ Î¬Î´ÎµÎ¹Î±!');
        const addresses = route.map(item => encodeURIComponent(item.a));
        const destination = addresses.pop();
        const waypoints = addresses.join('|');
        const url = `https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.google.com%2Fmaps%2Fdir%2F%3Fapi%3D1%26destination%3D%24&data=05%7C02%7C%7Caf83756683f4459b5a4d08de6d187825%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C639068149024201498%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&sdata=wUnOQ7mGBBi0jhUz95HwsZrW8dlPJkiA%2B7i54DN4DMc%3D&reserved=0{destination}&waypoints=${waypoints}&travelmode=driving`;
        window.open(url, '_blank');
    }

    renderBase();
</script>

</body>
</html>
