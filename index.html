<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Delivery Pro v9.2</title>
    <script src="https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2FSortable%2F1.15.0%2FSortable.min.js&data=05%7C02%7C%7Cda08e2dc02b0496c200c08de6cf2c2f5%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C639067987053065838%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&sdata=iZ55hccksDdZTBSBO6JhhvslEvzCjQDfDeYxyjtK1GM%3D&reserved=0"></script>
    <style>
        :root { --p: #30d158; --bg: #1c1c1e; --card: #2c2c2e; --txt: #ffffff; --accent: #30b0c7; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); margin: 0; padding-bottom: 120px; color: var(--txt); overflow-x: hidden; }
        .nav { display: flex; background: #000; padding-top: 45px; border-bottom: 1px solid #38383a; position: sticky; top: 0; z-index: 100; }
        .nav button { flex: 1; padding: 18px; border: none; background: none; font-weight: 700; color: #8e8e93; font-size: 12px; }
        .nav button.active { color: var(--p); border-bottom: 3px solid var(--p); }
        .container { padding: 16px; max-width: 600px; margin: auto; }
        .btn-full { background: var(--p); color: #000; width: 100%; padding: 20px; font-size: 18px; border-radius: 16px; border: none; font-weight: 800; margin-bottom: 20px; }
        .card { background: var(--card); border-radius: 16px; padding: 15px; margin-bottom: 12px; display: flex; align-items: center; border: 1px solid #38383a; }
        .handle { color: #48484a; font-size: 24px; padding-right: 15px; cursor: grab; }
        .info { flex: 1; overflow: hidden; }
        .info h4 { margin: 0; font-size: 17px; color: #fff; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; }
        .info p { margin: 4px 0 0 0; font-size: 13px; color: #8e8e93; }
        .notes { font-size: 12px; color: var(--accent); margin-top: 6px; font-weight: 600; }
        .time-tag { color: var(--p); font-size: 12px; font-weight: bold; background: rgba(48, 209, 88, 0.1); padding: 2px 6px; border-radius: 4px; margin-left: 5px; }
        .btn-go { background: var(--accent); color: #000; border: none; padding: 12px 18px; border-radius: 12px; font-weight: bold; margin-left: 10px; }
        .btn-del { background: #ff453a; color: #fff; border: none; padding: 10px; border-radius: 10px; margin-left: 8px; }
        .btn-edit { background: #48484a; color: #fff; border: none; padding: 10px; border-radius: 10px; margin-left: 8px; }
        .hidden { display: none; }
        textarea, input { background: #2c2c2e; border: 1px solid #38383a; color: #fff; padding: 15px; border-radius: 12px; width: 100%; box-sizing: border-box; font-size: 16px; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="nav">
    <button id="t1" onclick="tab('run')" class="active">Î”Î™Î‘Î”Î¡ÎŸÎœÎ—</button>
    <button id="t2" onclick="tab('base')">Î Î•Î›Î‘Î¤Î•Î£</button>
    <button id="t3" onclick="tab('set')">âš™ï¸ Î•Î™Î£Î‘Î“Î©Î“Î—</button>
</div>

<div id="run-page" class="container">
    <button class="btn-full" onclick="startRoute()">ğŸš€ Î•ÎÎ‘Î¡ÎÎ— NAVIGATION</button>
    <div id="run-list"></div>
    <button onclick="clearRun()" style="width:100%; color:#ff453a; background:none; border:none; padding:20px;">âŒ ÎšÎ‘Î˜Î‘Î¡Î™Î£ÎœÎŸÎ£ Î—ÎœÎ•Î¡Î‘Î£</button>
</div>

<div id="base-page" class="container hidden">
    <input type="text" id="search" placeholder="ğŸ” Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Ï€ÎµÎ»Î¬Ï„Î·..." onkeyup="renderBase()">
    <div id="base-list"></div>
</div>

<div id="set-page" class="container hidden">
    <h3>ÎœÎ±Î¶Î¹ÎºÎ® Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®</h3>
    <textarea id="bulk" rows="8" placeholder="ÎŒÎ½Î¿Î¼Î± .. Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· .. ÎÏÎ± .. Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚"></textarea>
    <button onclick="saveData()" class="btn-full">Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î—</button>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('delivery_db') || '[]');
    let rn = JSON.parse(localStorage.getItem('delivery_rn') || '[]');

    function tab(t) {
        document.querySelectorAll('.container').forEach(c => c.classList.add('hidden'));
        document.getElementById(t + '-page').classList.remove('hidden');
        document.querySelectorAll('.nav button').forEach(b => b.classList.remove('active'));
        if(t==='run') { document.getElementById('t1').classList.add('active'); renderRun(); }
        if(t==='base') { document.getElementById('t2').classList.add('active'); renderBase(); }
        if(t==='set') document.getElementById('t3').classList.add('active');
    }

    function saveData() {
        const text = document.getElementById('bulk').value;
        if(!text.trim()) return;
        text.split('\n').forEach(line => {
            const p = line.split('..');
            if(p.length >= 2) db.push({ n: p[0].trim(), a: p[1].trim(), t: p[2]?.trim() || "---", nt: p[3]?.trim() || "" });
        });
        localStorage.setItem('delivery_db', JSON.stringify(db));
        document.getElementById('bulk').value = '';
        tab('base');
    }

    function renderBase() {
        const s = document.getElementById('search').value.toLowerCase();
        const list = document.getElementById('base-list');
        list.innerHTML = '';
        db.forEach((item, i) => {
            if(item.n.toLowerCase().includes(s) || item.a.toLowerCase().includes(s)) {
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `
                    <div class="info">
                        <h4>${item.n} ${item.t !== '---' ? '<span class="time-tag">âŒš '+item.t+'</span>' : ''}</h4>
                        <p>${item.a}</p>
                        <div class="notes">${item.nt ? 'ğŸ”‘ ' + item.nt : ''}</div>
                    </div>
                    <button class="btn-go" style="background:var(--p)" onclick="addToRun(${i})">+</button>
                    <button class="btn-edit" onclick="editItem(${i})">âœ</button>
                    <button class="btn-del" onclick="deleteFromBase(${i})">âœ•</button>`;
                list.appendChild(div);
            }
        });
    }

    function editItem(i) {
        const n = prompt("ÎŒÎ½Î¿Î¼Î±:", db[i].n);
        const a = prompt("Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·:", db[i].a);
        const t = prompt("ÎÏÎ± (Ï€.Ï‡. 10:30):", db[i].t);
        const nt = prompt("Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚/ÎšÏ‰Î´Î¹ÎºÏŒÏ‚:", db[i].nt);
        if(n && a) {
            db[i] = { n, a, t, nt };
            localStorage.setItem('delivery_db', JSON.stringify(db));
            renderBase();
        }
    }

    function addToRun(i) {
        rn.push({...db[i]});
        rn.sort((a, b) => (a.t === "---" ? 1 : b.t === "---" ? -1 : a.t.localeCompare(b.t)));
        localStorage.setItem('delivery_rn', JSON.stringify(rn));
        alert('Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ!');
    }

    function renderRun() {
        const list = document.getElementById('run-list');
        list.innerHTML = '';
        rn.forEach((item, idx) => {
            const div = document.createElement('div');
            div.className = 'card'; div.dataset.id = idx;
            div.innerHTML = `
                <div class="handle">â˜°</div>
                <div class="info">
                    <h4>${item.n} ${item.t !== '---' ? '<span class="time-tag">âŒš '+item.t+'</span>' : ''}</h4>
                    <p>${item.a}</p>
                    <div class="notes">${item.nt ? 'ğŸ”‘ ' + item.nt : ''}</div>
                </div>
                <button class="btn-go" onclick="singleGo('${item.a}')">GO</button>
                <button class="btn-del" onclick="del(${idx})">âœ•</button>`;
            list.appendChild(div);
        });
    }

    function del(idx) { rn.splice(idx,1); localStorage.setItem('delivery_rn', JSON.stringify(rn)); renderRun(); }
    function clearRun() { if(confirm('ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚;')){ rn=[]; localStorage.setItem('delivery_rn', JSON.stringify(rn)); renderRun(); } }
    function deleteFromBase(i) { if(confirm('Î”Î¹Î±Î³ÏÎ±Ï†Î® Î±Ï€ÏŒ Ï„Î· Î²Î¬ÏƒÎ·;')){ db.splice(i,1); localStorage.setItem('delivery_db', JSON.stringify(db)); renderBase(); } }
    function singleGo(a) { window.location.href = "comgooglemaps://?daddr="+encodeURIComponent(a)+"&directionsmode=driving"; }
    function startRoute() {
        if(!rn.length) return;
        window.location.href = "comgooglemaps://?saddr=&daddr="+encodeURIComponent(rn.map(i=>i.a).join(' to:'))+"&directionsmode=driving";
    }

    new Sortable(document.getElementById('run-list'), { handle: '.handle', animation: 150, onEnd: () => {
        let newRn = [];
        document.querySelectorAll('#run-list .card').forEach(el => newRn.push(rn[el.dataset.id]));
        rn = newRn; localStorage.setItem('delivery_rn', JSON.stringify(rn));
        renderRun();
    }});

    tab('run');
</script>
</body>
</html>
