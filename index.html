<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Delivery Pro v30</title>
    <script src="https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2FSortable%2F1.14.0%2FSortable.min.js&data=05%7C02%7C%7C9ba3a11e844344f1057908de6d26c3f1%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C639068210429651303%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&sdata=k8DjDQjBz4XB3hZELjaXRF3jUiUOiHYLt43cGPCfodk%3D&reserved=0"></script>
    <style>
        :root { --green: #30D158; --red: #FF453A; --gray: #3A3A3C; --blue: #0A84FF; --bg: #000000; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: white; margin: 0; padding-top: 110px; }
        .top-nav { position: fixed; top: 0; width: 100%; background: #1C1C1E; z-index: 1000; border-bottom: 1px solid #38383A; }
        .tab-bar { display: flex; justify-content: space-around; padding: 10px 0; }
        .tab-btn { padding: 12px; border: none; background: none; font-weight: bold; color: #8E8E93; flex: 1; cursor: pointer; }
        .tab-btn.active { color: var(--green); border-bottom: 3px solid var(--green); }
        .card { background: #1C1C1E; margin: 8px; padding: 12px; border-radius: 12px; display: flex; align-items: center; border: 1px solid #2C2C2E; }
        .info { flex: 1; margin: 0 10px; overflow: hidden; }
        .name { font-weight: bold; font-size: 1.1em; color: white; display: block; }
        .addr { color: #8E8E93; font-size: 0.85em; display: block; margin-top: 2px; }
        .details { color: var(--green); font-size: 0.85em; font-weight: bold; margin-top: 4px; display: block; }
        .btn-group { display: flex; gap: 8px; }
        .btn { border: none; border-radius: 8px; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; cursor: pointer; color: white; }
        .btn-add { background: var(--green); color: black; font-size: 1.6em; }
        .btn-edit { background: var(--gray); font-size: 1.2em; }
        .btn-del { background: var(--red); font-size: 1.2em; }
        .handle { color: #48484A; padding-right: 12px; font-size: 1.6em; cursor: grab; }
        .btn-go { background: var(--green); color: black; width: 92%; margin: 15px auto; display: block; font-size: 1.3em; padding: 18px; border-radius: 15px; font-weight: bold; text-align: center; border: none; }
        .btn-clear { background: transparent; color: var(--red); width: 60%; margin: 0 auto 15px; display: block; padding: 10px; border: 1px solid var(--red); border-radius: 10px; font-weight: bold; }
        .search-bar { width: 90%; padding: 14px; margin: 10px auto; border-radius: 12px; border: 1px solid #38383A; background: #1C1C1E; color: white; display: block; }
        #bulk { width: 90%; height: 120px; background: #1C1C1E; color: white; border: 1px solid #38383A; border-radius: 12px; padding: 12px; margin: 10px auto; display: block; }
    </style>
</head>
<body>

<div class="top-nav">
    <div class="tab-bar">
        <button class="tab-btn active" id="btn-route" onclick="tab('route')">Î”Î™Î‘Î”Î¡ÎŸÎœÎ—</button>
        <button class="tab-btn" id="btn-base" onclick="tab('base')">Î Î•Î›Î‘Î¤Î•Î£</button>
        <button class="tab-btn" id="btn-settings" onclick="tab('settings')">âš™ï¸ Î•Î™Î£Î‘Î“Î©Î“Î—</button>
    </div>
</div>

<div id="route-view">
    <button class="btn-go" onclick="startNav()">ğŸš€ Î•ÎÎ‘Î¡ÎÎ— GOOGLE MAPS</button>
    <button class="btn-clear" onclick="clearRoute()">ğŸ—‘ï¸ ÎšÎ‘Î˜Î‘Î¡Î™Î£ÎœÎŸÎ£ Î”Î™Î‘Î”Î¡ÎŸÎœÎ—Î£</button>
    <div id="route-list"></div>
</div>

<div id="base-view" style="display:none;">
    <input type="text" class="search-bar" id="search" placeholder="ğŸ” Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·..." oninput="renderBase()">
    <div id="base-list"></div>
</div>

<div id="settings-view" style="display:none; text-align: center; padding-top: 20px;">
    <textarea id="bulk" placeholder="ÎŒÎ½Î¿Î¼Î± .. Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· .. ÎÏÎ±"></textarea>
    <button class="btn" style="background:var(--blue); width:90%; margin:10px auto; height:55px;" onclick="saveData()">ğŸ’¾ Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î—</button>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('delivery_db')) || [];
    let route = JSON.parse(localStorage.getItem('delivery_route')) || [];

    function tab(name) {
        document.getElementById('base-view').style.display = name === 'base' ? 'block' : 'none';
        document.getElementById('route-view').style.display = name === 'route' ? 'block' : 'none';
        document.getElementById('settings-view').style.display = name === 'settings' ? 'block' : 'none';
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('btn-' + name).classList.add('active');
        if(name === 'base') renderBase();
        if(name === 'route') renderRoute();
    }

    function renderBase() {
        const query = document.getElementById('search').value.toLowerCase();
        const list = document.getElementById('base-list');
        list.innerHTML = '';
        db.sort((a,b) => a.n.localeCompare(b.n, 'el'));
        db.filter(i => i.n.toLowerCase().includes(query)).forEach((item, idx) => {
            list.innerHTML += `<div class="card">
                <div class="info">
                    <span class="name">${item.n}</span>
                    <span class="addr">${item.a}</span>
                    <span class="details">ğŸ•’ ${item.t || '---'}</span>
                </div>
                <div class="btn-group">
                    <button class="btn btn-add" onclick="addToRoute(${idx})">+</button>
                    <button class="btn btn-edit" onclick="editItem(${idx})">âœ</button>
                    <button class="btn btn-del" onclick="deleteItem(${idx})">Ã—</button>
                </div>
            </div>`;
        });
    }

    function renderRoute() {
        const list = document.getElementById('route-list');
        list.innerHTML = '';
        route.forEach((item, idx) => {
            list.innerHTML += `<div class="card" data-idx="${idx}">
                <div class="handle">â˜°</div>
                <div class="info">
                    <span class="name">${idx+1}. ${item.n}</span>
                    <span class="addr">${item.a}</span>
                </div>
                <button class="btn btn-del" onclick="removeFromRoute(${idx})">Ã—</button>
            </div>`;
        });
        if(route.length > 0) {
            new Sortable(list, { handle: '.handle', animation: 150, onEnd: function() {
                let newR = [];
                list.querySelectorAll('.card').forEach(el => newR.push(route[el.dataset.idx]));
                route = newR; localStorage.setItem('delivery_route', JSON.stringify(route));
                renderRoute();
            }});
        }
    }

    function editItem(idx) {
        let n = prompt("ÎŒÎ½Î¿Î¼Î±:", db[idx].n);
        let a = prompt("Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ·:", db[idx].a);
        let t = prompt("ÎÏÎ±/ÎšÏ‰Î´Î¹ÎºÏŒÏ‚:", db[idx].t || "");
        if(n && a) {
            db[idx] = { n, a, t };
            localStorage.setItem('delivery_db', JSON.stringify(db));
            renderBase();
        }
    }

    // Î— Î”Î™ÎŸÎ¡Î˜Î©Î£Î— Î“Î™Î‘ Î¤ÎŸ GOOGLE MAPS
    function startNav() {
        if(route.length === 0) return alert('Î ÏÏŒÏƒÎ¸ÎµÏƒÎµ ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚!');
       
        // Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ¼Îµ Ï„Î¿ ÎºÎ»Î±ÏƒÎ¹ÎºÏŒ Google Maps URL Ï€Î¿Ï… Î´Î¿Ï…Î»ÎµÏÎµÎ¹ Ï€Î±Î½Ï„Î¿Ï
        let waypoints = route.map(r => r.a.trim()).join('/');
        let finalUrl = "https://emea01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.google.com%2Fmaps%2Fdir%2F&data=05%7C02%7C%7C9ba3a11e844344f1057908de6d26c3f1%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C639068210429665803%7CUnknown%7CTWFpbGZsb3d8eyJFbXB0eU1hcGkiOnRydWUsIlYiOiIwLjAuMDAwMCIsIlAiOiJXaW4zMiIsIkFOIjoiTWFpbCIsIldUIjoyfQ%3D%3D%7C0%7C%7C%7C&sdata=kD1RSuSZAhmmswz7fb3xyy3NgXEPrNEpOw43CyhrcAg%3D&reserved=0" + waypoints;
       
        window.open(encodeURI(finalUrl), '_blank');
    }

    function addToRoute(i) { route.push(db[i]); localStorage.setItem('delivery_route', JSON.stringify(route)); alert('ÎœÏ€Î®ÎºÎµ!'); }
    function removeFromRoute(i) { route.splice(i,1); localStorage.setItem('delivery_route', JSON.stringify(route)); renderRoute(); }
    function clearRoute() { if(confirm('Î£Î²Î®ÏƒÎ¹Î¼Î¿ Î´Î¹Î±Î´ÏÎ¿Î¼Î®Ï‚;')) { route = []; localStorage.setItem('delivery_route', JSON.stringify(route)); renderRoute(); } }
    function deleteItem(i) { if(confirm('Î”Î¹Î±Î³ÏÎ±Ï†Î®;')) { db.splice(i,1); localStorage.setItem('delivery_db', JSON.stringify(db)); renderBase(); } }
   
    function saveData() {
        document.getElementById('bulk').value.split('\n').forEach(l => {
            let p = l.split('..');
            if(p.length >= 2) db.push({ n: p[0].trim(), a: p[1].trim(), t: p[2] ? p[2].trim() : "" });
        });
        localStorage.setItem('delivery_db', JSON.stringify(db));
        document.getElementById('bulk').value = ''; tab('base');
    }

    tab('route');
</script>
</body>
</html>
